
## 网络优化

优化主要体现在三方面：`请求响应速度`、`弱网处理`、`安全`

#### 请求速度：
w
- 1.使用HTTPDNS，直接让APP去请求自己的服务器进行域名解析，后面直接使用ip地址进行请求。既预防DNS劫持，同时又能省去DNS解析的时间。
- 2.连接使用长连接和多路复用。默认开启keepalive，由于http1.1长连接的队头阻塞问题，需要使用多路复用。但HTTP2普及型不高，可以使用一些自己实现了多路复用的网络库，比如微信开源的Mars。
- 3.TCP层的队头阻塞，改用google设计的QUIC协议，它使用了UDP来实现。
- 4.数据对请求速度的影响分两方面，一是压缩率，二是解压序列化反序列化的速度。
  	
```  	
 	目前最流行的两种数据格式是 json 和 protobuf，json 是字符串，protobuf 是二进制，即使用各种压缩算法压缩后，protobuf 仍会比 json 小，数据量上 protobuf 有优势，序列化速度 protobuf 也有一些优势。
  	
  	压缩算法多种多样，也在不断演进，最新出的 Brotli 和Z-standard实现了更高的压缩率，Z-standard 可以根据业务数据样本训练出适合的字典，进一步提高压缩率，目前压缩率表现最好的算法。
	
	除了传输的 body 数据，每个请求 HTTP 协议头的数据也是不可忽视，HTTP2 里对 HTTP 协议头也进行了压缩，HTTP 头大多是重复数据，固定的字段如 method 可以用静态字典，不固定但多个请求重复的字段例如 cookie 用动态字典，可以达到非常高的压缩率
```

#### 弱网

- 1.复合连接，建立连接时，
```
	阶梯式并发连接，其中一条连通后其他连接都关闭。这个方案结合串行和并发的优势，提高弱网下的连接成功率，同时又不会增加服务器资源消耗
```	
- 2.制定最合适的超时时间
```
	对总读写超时(从请求到响应的超时)、首包超时、包包超时(两个数据段之间的超时)时间制定不同的计算方案，加快对超时的判断，减少等待时间，尽早重试。这里的超时时间还可以根据网络状态动态设定。
```
- 3.调优TCP参数，使用TCP优化算法。
```
	对服务端的TCP协议参数进行调优，以及开启各种优化算法，使得适合业务特性和移动端网络环境，包括RTO初始值，混合慢启动，TLP，F-RTO等。
```

#### 安全
使用SSL/TSL