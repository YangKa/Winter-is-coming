## HTTP

### GET和POST

- GET请求：参数在地址后拼接，没有请求数据，不安全（因为所有参数都拼接在地址后面），不适合传输大量数据（长度有限制，为1024个字节）。

        GET提交、请求的数据会附在之后，即把数据放置在HTTP协议头<requestline>中。以？分割和传输数据，多个参数用&连接。如果数据是英文字母或数字，原样发送，如果是空格，转换为+，如果是中文/其他字符，则直接把字符串用BASE64加密。

- POST请求：参数在请求数据区放着，相对GET请求更安全，并且数据大小没有限制。把提交的数据放置在HTTP包的包体<request-body>中.
- GET提交的数据会在地址栏显示出来，而POST提交，地址栏不会改变。

### HTTP和HTTPS

- HTTP超文本传输协议，是短连接，是客户端主动发送请求，服务器做出响应，服务器响应之后，链接断开。HTTP是一个属于应用层面向对象的协议，HTTP有两类报文：请求报文和响应报文。
- HTTP请求报文：一个HTTP请求报文由请求行、请求头部、空行和请求数据4部分组成。
- HTTP响应报文：由三部分组成：状态行、消息报头、响应正文。
- HTTPS 安全超文本传输协议（Secure Hypertext Transfer Protocol），它是一个安全通信通道，基于HTTP开发，用于客户计算机和服务器之间交换信息，使用安全套结字层（SSI）进行信息交换，即HTTP的安全版。

### Socket和HTTP

- HTTP协议是基于TCP连接的，是应用层协议，主要解决如何包装数据。
- HTTP是短连接，用于一次性请求，服务器响应后断开连接，节省资源。
- Socket是对TCP/IP协议的封装，Socket本地不是协议，而是一个调用接口.
- Socket是长连接，客户端和服务器可以双向通信，用于实时性场景。

### 管道技术

在HTTP 1.0之前都是短连接，就是一个请求一个连接。从1.1开始使用pipeline，相同地址的连接可以进行公用，这就是持久连接。

多个相同地址的请求按照先后顺序发送数据，类似管道一样，这就是管道技术，也叫连接串行复用。

也可以采用并发的方式达到多路复用，提高性能。


### 版本演化

1.0
短连接、头部阻塞（head of line blocking）

1.1
支持长连接，但服务器必须按接收到客户端的请求顺序依次返回响应结果

2.0
多路复用（减少TCP连接数，降低慢启动概率）
二进制分帧（将所有传输的信息分割为更小的消息和帧（frame）,并对它们采用二进制格式的编码 ）

### 建立长连接

方案一：基于tcp的长链接（例如google的protobuf）
基于tcp协议建立一条自己的长链接通道。基于tcp的socket编程技术难度相对复杂很多，而且需要自己制定协议，但带来的回报也很大。信息的上报和推送变得更及时，在请求量爆发的时间点还能减轻服务器压力（http短连接模式会频繁的创建和销毁连接）。


方案二：http long-polling（推送）
客户端在初始状态就会发送一个polling（轮寻）请求到服务器，服务器并不会马上返回业务数据，而是等待有新的业务数据产生的时候再返回。所以连接会一直被保持，一旦结束马上又会发起一个新的polling请求，如此反复，所以一直会有一个连接被保持。
polling的response有可能会被中间代理cache住，要处理好业务数据的过期机制。long-polling方式还有一些缺点是无法克服的，比如每次新的请求都会带上重复的header信息，还有数据通道是单向的，主动权掌握在server这边，客户端有新的业务请求的时候无法及时传送。


方案三：http streaming
同long-polling不同的是，server并不会结束初始的streaming请求，而是持续的通过这个通道返回最新的业务数据。这个数据通道是单向的。streaming是通过在server response的头部里增加”Transfer Encoding: chunked”来告诉客户端后续还会有新的数据到来。
几个缺陷：
- 有些代理服务器会等待服务器的response结束之后才会将结果推送到请求客户端。对于streaming这种永远不会结束的方式来说，客户端就会一直处于等待response的过程中。
- 业务数据无法按照请求来做分割，所以客户端每收到一块数据都需要自己做协议解析，也就是说要做自己的协议定制。
- streaming不会产生重复的header数据。


方案四：web socket
WebSocket和传统的tcp socket连接相似，也是基于tcp协议，提供双向的数据通道。WebSocket优势在于提供了message的概念，比基于字节流的tcp socket使用更简单，同时又提供了传统的http所缺少的长连接功能。





